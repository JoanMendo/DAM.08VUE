<!DOCTYPE html>
<html>

<head>
    <script src="https://unpkg.com/vue@3"></script>
    <link rel="stylesheet" type="text/css" href="2.css">
</head>

<body>
    
    <div id="app">
        <ul>
            <h2>Champions</h2>
            <li>    
                <label for="hpFilter">Filtrar por vida:</label>
                <input type="text" v-model="filterHP" placeholder="Buscar por vida" @input="conectAPI">
                <label for="nameFilter">Filtrar por nombre:</label>
                <input type="text" v-model="filterName" placeholder="Buscar por nombre" @input="conectAPI">
            </li>
            <h2 v-if="champs.length == 0">Ningun campe√≥n cumple esos parametros</h2>
            <li v-for="(champion, key) in champs" :key="key">
                <img :src="'https://ddragon.leagueoflegends.com/cdn/14.7.1/img/champion/' + champion.image.full"
                    :alt="champion.name" width="100" height="100">
                <h2>{{ champion.id}}</h2>
                <p>{{ champion.description }}</p>
            </li>
        </ul>
    </div>

    <script>
        const app = Vue.createApp({
            data() {
                return {
                    champs: [],
                    filterHP: 400,
                    filterName: ""
                }
            },
            methods: {
                conectAPI() {


                    fetch("https://ddragon.leagueoflegends.com/cdn/14.7.1/data/en_US/champion.json")
                        .then(res => {
                            if (res.ok) {
                                return res.json();
                            }
                            else
                                throw new Error("La API no va");
                        })
                        .then(json => {
                            const championsData = json.data;
                            const championsArray = Object.values(championsData);
                            this.champs = championsArray.
                            filter(champion => champion.stats.hp > this.filterHP)
                            .filter(champion => {
                            if (this.filterName === ""){
                                return true;
                            }
                            else {
                                return champion.id.toLowerCase().includes(this.filterName)}
                            })
                            .map(champion => {
                                return {
                                    id: champion.id,
                                    image: champion.image,
                                    description: champion.blurb,
                                    health: champion.stats.hp
                                }
                            });
                        })
                }
            }
        });

        const appMounted = app.mount('#app');
        appMounted.conectAPI();
        



    </script>
</body>

</html>